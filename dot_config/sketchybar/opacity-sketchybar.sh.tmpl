{{- /* SketchyBar Opacity - Generated by theme system */ -}}
{{- /* This file is managed by chezmoi on bootstrap, and by theme-manager.py during runtime */ -}}
{{- /* Opacity: 0=invisible, 100=fully opaque/solid */ -}}
#!/bin/bash
{{- $opacity := .theme.opacity | default 0 -}}

{{- if gt $opacity 0 }}
# Opacity: {{ $opacity }}% (0=invisible, 100=solid)
export OPACITY_ENABLED=true
export OPACITY_ALPHA="{{ printf "0x%02x" (div (mul $opacity 255) 100) }}"
export BLUR_RADIUS=30
{{- else }}
# Opacity: 0% (fully opaque)
export OPACITY_ENABLED=false
export OPACITY_ALPHA="0xff"
export BLUR_RADIUS=0
{{- end }}

# Helper function to add opacity to ARGB colors
# Usage: add_opacity "0xff1e1e2e" â†’ "0xa51e1e2e" (with current opacity)
add_opacity() {
  local color="$1"
  # Strip 0xff prefix if present, or 0x prefix, or # prefix
  color="${color#0xff}"
  color="${color#0x}"
  color="${color#\#}"
  # Return with opacity alpha
  echo "0x${OPACITY_ALPHA#0x}${color}"
}
